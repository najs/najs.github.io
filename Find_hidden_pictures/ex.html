<!DOCTYPE html>
<html lang="en">
<head>
	<meta charset="UTF-8">
	<title>canvas</title>

	<style>
canvas{background-color:#ffffff;}
	</style>
</head>
<body>
<!--<canvas id="myCanvas"></canvas>-->
<canvas id="myCanvas2"></canvas>
<p>찍어라! 위치값! : <span id="numPos"></span></p>


<script>
	/*function writePsition(canvas, message) {
		var context = canvas.getContext('2d');
		context.clearRect(0, 0, canvas.width, canvas.height);
		context.font = '18pt Calibri';
		context.fillStyle = 'black';
		context.fillText(message, 10, 25);
	}*/


	function getMousePos(canvas, event) {
		var rect = canvas.getBoundingClientRect();
		return {
			x: event.clientX - rect.left,
			y: event.clientY - rect.top
		};
	}

	var croppingImg = function(src, mPosX, mPosY) {
		var tmpCanvas = document.getElementById('myCanvas2');
		var tmpCtx = tmpCanvas.getContext('2d');
		var thumbImg = document.createElement('img');

		tmpCanvas.width = tmpCanvas.height = 700;
		thumbImg.src = src;

		thumbImg.onload = function() {
			tmpCtx.save();
			tmpCtx.beginPath();
			//tmpCtx.rect(mPosX, mPosY,100,100);
			tmpCtx.arc(mPosX, mPosY, 100, 0, 2*Math.PI);

			tmpCtx.clip();
			tmpCtx.drawImage(thumbImg, 0, 0, 700, 700, 0, 0, 700, 700); //drawImage(이미지, 자르기기준x, 자르기기준y, 자르기w, 자르기h, 기준x, 기준y, w, h)
			tmpCtx.closePath();
		};
	};


	var src = 'kaka_welcome.jpg';

	croppingImg(src);
	var canvas = document.getElementById('myCanvas2');
	var numPos = document.getElementById('numPos');
	var context = canvas.getContext('2d');
	canvas.width = canvas.height = 700;

	canvas.addEventListener('mousemove', function(e) {
		var mousePos = getMousePos(canvas, e);
		//var message = '마우스 포인트 위치: ' + mousePos.x + ', ' + mousePos.y;
		//writePsition(canvas, message);
		numPos.innerHTML = mousePos.x +', '+ mousePos.y;

		croppingImg(src,mousePos.x,mousePos.y);
		context.clearRect(0,0,canvas.width, canvas.height);
	}, false);


</script>
</body>
</html>